<%= form_with(model: @question, local: true) do |f| %>
  <h2>チャレンジ（親）</h2>
  <div>
    <%= f.label :title, "チャレンジ名" %>
    <%= f.text_field :title %>
  </div>
  <div>
    <%= f.label :description, "説明" %>
    <%= f.text_area :description %>
  </div>

  <h2>問題（子）</h2>
  <div id="children">
    <%= f.fields_for :children do |cf| %>
      <div class="nested-fields" style="border:1px solid #aaa; margin:10px; padding:10px;">
        <%= cf.label :title, "問題タイトル" %>
        <%= cf.text_field :title %>
        <%= cf.label :description, "問題説明" %>
        <%= cf.text_area :description %>
        <%# cf.link_to_remove "この問題を削除", cf.object, data: { confirm: "本当に削除しますか？" } %>

        <h4>選択肢</h4>
        <div class="choices">
          <%= cf.fields_for :choices do |chf| %>
            <div class="nested-fields" style="margin-left:20px;">
              <%= chf.label :content, "選択肢" %>
              <%= chf.text_field :content %>
              <%= chf.radio_button :is_correct, true %> 正解
              <%= chf.link_to_remove "選択肢削除", chf.object %>
            </div>
          <% end %>
          <%= cf.link_to_add "選択肢を追加", :choices, data: { association_insertion_node: '.choices', association_insertion_method: :append } %>
        </div>
      </div>
    <% end %>
    <%= f.link_to_add "問題を追加", :children, data: { association_insertion_node: '#children', association_insertion_method: :append } %>
  </div>

  <%= f.submit %>
<% end %>