<div class="flex flex-col items-center justify-center min-h-screen bg-gray-50">
  <div class="w-full max-w-2xl bg-white rounded-xl shadow-lg p-8 border border-purple-100">
    <h2 class="text-2xl font-bold mb-8 text-purple-700 text-center">チャレンジ結果まとめ</h2>
    <table class="w-full mb-8 border-collapse">
      <thead>
        <tr>
          <th class="py-3 px-4 bg-purple-100 text-purple-700 font-bold border-b">問題</th>
          <th class="py-3 px-4 bg-purple-100 text-purple-700 font-bold border-b">あなたの選択</th>
          <th class="py-3 px-4 bg-purple-100 text-purple-700 font-bold border-b">正誤</th>
        </tr>
      </thead>
      <tbody>
        <% @answers.each do |answer| %>
          <tr class="hover:bg-purple-50 transition">
            <td class="py-2 px-4 border-b"><%= answer.question.title %></td>
            <td class="py-2 px-4 border-b"><%= answer.choice&.content %></td>
            <td class="py-2 px-4 border-b font-bold text-center <%= answer.is_correct ? 'text-red-600' : 'text-blue-600' %>">
              <%= answer.is_correct ? "○" : "×" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <div class="flex justify-center">
      <% selected_cat = session[:selected_category_id] %>
      <% if selected_cat.present? %>
        <%= link_to "カテゴリ内の一覧に戻る", category_path(selected_cat), class: "px-6 py-2 bg-purple-500 hover:bg-purple-600 text-white font-bold rounded-full shadow transition" %>
      <% else %>
        <%= link_to "チャレンジ一覧に戻る", questions_path, class: "px-6 py-2 bg-purple-500 hover:bg-purple-600 text-white font-bold rounded-full shadow transition" %>
      <% end %>
    </div>
    <div class="mt-4 text-center">
      <% total = @total || @answers.size %>
      <% correct = @correct || @answers.count{|a| a.is_correct } %>
      <% tweet_text = "チャレンジ『#{@parent.title}』の結果: #{correct}/#{total} 正解しました！ #%E3%83%9C%E3%82%AD%E3%83%A3%E3%82%AF%E3%83%A9%E3%82%BB%E3%83%B3" %>
      <% tweet_url = "https://twitter.com/intent/tweet?text=" + ERB::Util.url_encode(tweet_text) + "&url=" + ERB::Util.url_encode(request.original_url) %>
      <a href="<%= tweet_url %>" target="_blank" rel="noopener noreferrer" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded">結果をXで共有</a>
    </div>
  </div>
</div>