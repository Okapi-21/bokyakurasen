# frozen_string_literal: true

puts "Seeding custom explanations..."

mapping = {
  # Git
  'Gitは何を管理するツールですか？' => 'Gitはファイルの変更履歴を管理するツールです。コミット単位で変更を保存し、過去の状態に戻したり、ブランチで並行作業ができます。',
  '新しいリポジトリを作成するコマンドは？' => '`git init` は現在のディレクトリを新しいGitリポジトリとして初期化します。リポジトリを最初に作るときに使います。',
  '変更をステージするコマンドは？' => '`git add` で変更したファイルを次のコミットに含めるためにステージします。ステージした内容だけがコミットされます。',
  'コミットを作成するコマンドは？' => '`git commit -m "msg"` でステージ済みの変更を1つのコミット（履歴の単位）として保存します。メッセージは変更内容の要約です。',
  'リモートリポジトリを取得してローカルを更新するコマンドは？' => '`git pull` はリモートの更新を取得（fetch）して自動的にマージし、ローカルを最新にします。共同作業でよく使います。',
  'ブランチを新規作成するコマンドは？' => '`git branch <name>` で新しいブランチを作成します。作成後は `git checkout` または `git switch` で切り替えます。',
  '現在の変更状態を確認するコマンドは？' => '`git status` は現在の作業ツリーとステージの状況を表示し、どのファイルが変更されているか確認できます。',
  'リモートを追加するコマンドは？' => '`git remote add origin <url>` でリモートリポジトリを origin という名前で登録します。push/pullで使うURLを登録します。',
  'ブランチを切り替えるコマンドは？' => '`git checkout <branch>` で別のブランチに切り替えます。最近は `git switch` の使用も推奨されています。',
  'コミットをリモートへ送るコマンドは？' => '`git push` でローカルのコミットをリモートリポジトリに送信します。共同作業者がリモートから取得できます。',

  # Docker
  'Dockerの主な目的は？' => 'Dockerはアプリケーションをコンテナとして分離して実行することで、環境差異を減らし、配布やスケーリングを簡単にします。',
  'イメージからコンテナを起動するコマンドは？' => '`docker run` はイメージから新しいコンテナを作成して実行します。オプションでポートやボリュームを指定します。',
  'Dockerfileは何を定義するファイルですか？' => 'Dockerfileはイメージをビルドするための手順（ベースイメージ、ファイル追加、コマンド実行など）をテキストで記述するファイルです。',
  'バックグラウンドでコンテナを実行するオプションは？' => '`-d` オプションを付けると、コンテナをデタッチ（バックグラウンド実行）できます。ログは `docker logs` で確認します。',
  '現在のコンテナ一覧を表示するコマンドは？' => '`docker ps` は現在実行中のコンテナ一覧を表示します。`-a` を付けると停止済みも含めた全てを表示します。',
  'イメージをビルドするコマンドは？' => '`docker build -t name .` は現在ディレクトリにある Dockerfile を元にイメージを作成し、タグを付けます。',
  'ホストとコンテナのポートをマッピングするオプションは？' => '`-p ホスト:コンテナ` を使うと、ホスト側のポートとコンテナ内のポートを接続します。例: `-p 3000:3000`。',
  '永続化のためにホストとマウントするのは？' => 'データの永続化にはボリュームを使います。コンテナは停止すると消えるため、ボリュームでホスト側に保存します。',
  'docker-composeは何のためのツール？' => 'docker-composeは複数のコンテナ構成を1つの設定ファイルで定義し、一度に起動・停止できるようにするツールです。',
  '実行中のコンテナに入るコマンドは？' => '`docker exec -it <container> /bin/bash` でコンテナ内のシェルを開き、動作確認やデバッグができます。',

  # Ruby on rails
  'Railsで新しいアプリを作るコマンドは？' => '`rails new myapp` で新しいRailsアプリケーションの雛形を生成します。必要なGemfileやディレクトリ構成が作成されます。',
  'モデル、コントローラ、ビュー等を一括生成するコマンドは？' => '`rails generate scaffold <name>` はモデル・マイグレーション・コントローラ・ビューを一括生成し、CRUDをすばやく作れます。',
  'データベースのマイグレーションを実行するコマンドは？' => '`rails db:migrate` でマイグレーションを適用し、スキーマを最新にします。複数のバージョン管理が可能です。',
  'Railsのルーティング設定はどのファイルに書く？' => '`config/routes.rb` にルーティングを定義します。HTTPメソッドとパスをコントローラのアクションに結び付けます。',
  'コントローラのアクションでビューに渡すパラメータを安全に受け取る仕組みは？' => 'Strong Parameters を使って、許可されたパラメータのみをコントローラで受け取るようにしてセキュアに扱います。',
  'モデルの関連を定義するメソッドは？' => 'モデル間の関係は `has_many` や `belongs_to` で定義します。関連を使うと関連レコードへ簡単にアクセスできます。',
  'Railsコンソールを起動するコマンドは？' => '`rails console`（短縮形 `rails c`）でアプリケーション環境のREPLを起動し、DB操作やデバッグができます。',
  '部分テンプレート（パーシャル）はどのように呼び出す？' => '`render partial: "name"` または `render "name"` で部分テンプレートを呼び出し、ビューの再利用ができます。',
  'バリデーションをモデルに追加するには？' => '`validates :name, presence: true` のようにモデルに記述してバリデーションを定義し、保存前に検証します。',
  'Railsサーバーを起動するコマンドは？' => '`rails server` または `rails s` で開発用サーバを起動し、ブラウザでアクセスできます。'
}

updated = 0

mapping.each do |title, text|
  q = Question.find_by(title: title)
  next unless q
  q.update!(explanation: text)
  updated += 1
end

puts "Updated custom explanations for #{updated} questions"
